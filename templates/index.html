<!DOCTYPE html>
<html>
  <head>
    <link rel="stylesheet" href="/static/css/globals.css" />
    <link rel="stylesheet" href="/static/css/styleguide.css" />
    <link rel="stylesheet" href="/static/css/style.css" />
    <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js" type="text/javascript"></script>
    <script src="https://togetherjs.com/togetherjs-min.js"></script>
    <title>SciMerge</title>
  </head>
  <body>
    <div class="user-dashboard">
      <div class="div">
        <div class="navigation-drawer">
          
          <div class="state-layer-wrapper">
            <div class="state-layer">
              <img class="img" src="/static/icons/dashboard.svg" />
              <div class="text-wrapper-3">Dashboard</div>
              <div class="badge-label-text-2">100+</div>
            </div>
          </div>
          <div class="state-layer-wrapper">
            <div class="state-layer">
              <img class="img" src="/static/icons/newproject.svg" />
              <div class="text-wrapper-3">Create A Project</div>
              <div class="badge-label-text-2">100+</div>
            </div>
          </div>

          <div class="state-layer-wrapper">
            <div class="state-layer">
              <img class="img" src="/static/icons/community.svg" />
              <div class="text-wrapper-3">Community</div>
              <div class="badge-label-text-2">100+</div>
            </div>
          </div>

          <div style="text-align: center;">
          <button onclick="TogetherJS(this); return false;" class="login-button">Collaborate</button>
        </div>
        </div>
        <div class="top-app-bar">
          <div class="div-2">
            <div class="container">
              
                <img  style="height: 50px; width: 50px;" src="/static/icons/logo.png" alt="sitelogo" />
              
            </div>
          </div>
          <div class="headline-2">SciMerge</div>
          <div class="div-2">
            <div class="container">
              <div class="img-wrapper"><img class="img2" src="/static/icons/account_circle_filled_24px.svg" /></div>
            </div>
          </div>
        </div>
        <div class="horizontal-card">
          <div class="card-state-layer"></div>
          <div class="content-container">
            <div class="header">
              <div class="content">
                <div class="text">
                  <div class="header-2">Header</div>
                  <div class="subhead">Subhead</div>
                </div>
              </div>
              <div class="media"><img class="media-2" src="/static/icons/media-2.png" /></div>
            </div>
          </div>
        </div>
        <div class="search-bar">
          <div class="state-layer-2">
            <div class="div-2"></div>
            <div class="supporting-text-wrapper"><div class="supporting-text">Explain what you want</div></div>
            <div class="trailing-elements">
              <div class="div-2">
                <div class="container">
                  <div class="img-wrapper"><img class="img2" src="/static/icons/icon-3.svg" /></div>
                </div>
              </div>
            </div>
          </div>
        </div>
        <div class="frame">
          <div class="content-wrap">
          <p class="p content-wrap" >Hi {{userdata.firstname}}, what are you looking for today?</p>
          </div>
          <div class="stacked-card" id="createproject">
            <div class="card-state-layer-2"></div>
            <div class="content-container">
              <div class="media-text-content">
                <div class="header-3">
                  <div class="content-2">
                    <div class="text">
                      <div class="header-2">Create a new project</div>
                      <p class="subhead-2">Start by creating a new project</p>
                    </div>
                  </div>
                </div>
                <div class="media-3"></div>
              </div>
            </div>
          </div>
          <div class="stacked-card" id="joinproject">
            <div class="card-state-layer-2"></div>
            <div class="content-container">
              <div class="media-text-content">
                <div class="header-3">
                  <div class="content-2">
                    <div class="text">
                      <div class="header-2">Join an existing project</div>
                      <p class="subhead-2">Browse amongst projects and join one</p>
                    </div>
                  </div>
                </div>
                <div class="media-4"></div>
              </div>
            </div>
          </div>
          <div class="text-wrapper-4">Current projects</div>
          
        </div>
        </div>
        <div class="frame-2">
          <div class="frame-3">
            <div class="text-wrapper-5">Past projects</div>
            <button class="button">
              <div class="label-text-wrapper"><div class="label-text">View all</div></div>
            </button>
          </div>
          <div class="frame-4">
            <div class="horizontal-card-3">
              <div class="card-state-layer-3"></div>
              <div class="content-container">
                <div class="header-4">
                  <div class="content">
                    <div class="text">
                      <div class="header-2">Header</div>
                      <div class="subhead">Subhead</div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
            <div class="horizontal-card-3">
              <div class="card-state-layer-3"></div>
              <div class="content-container">
                <div class="header-4">
                  <div class="content">
                    <div class="text">
                      <div class="header-2">Header</div>
                      <div class="subhead">Subhead</div>
                    </div>
                  </div>
                  <div class="media"></div>
                </div>
              </div>
            </div>
            <div class="horizontal-card-3">
              <div class="card-state-layer-3"></div>
              <div class="content-container">
                <div class="header-4">
                  <div class="content">
                    <div class="text">
                      <div class="header-2">Header</div>
                      <div class="subhead">Subhead</div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
            <div class="horizontal-card-3">
              <div class="card-state-layer-3"></div>
              <div class="content-container">
                <div class="header-4">
                  <div class="content">
                    <div class="text">
                      <div class="header-2">Header</div>
                      <div class="subhead">Subhead</div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </body>
  <script>
    function fetchCurrentProjects() {
      var i=0;
      console.log('{{currentprojects | tojson | safe}}'.slice(1,-1));
      projectids=JSON.parse('{{currentprojects | tojson | safe}}'.slice(1,-1));
      console.log(projectids);
      for (i=0;i<projectids.length;i++) {
        var project = projectids[i];
        console.log(project);
        fetch('/webapi/project/'+project).then(function(response) {
          return response.json();
        }).then(function(jsonResponse) {
          console.log(jsonResponse);
          var project = jsonResponse;
          var projectcard = document.createElement('div');
          projectcard.className = 'horizontal-card-2';
          var cardstate = document.createElement('div');
          cardstate.className = 'card-state-layer';
          var contentcontainer = document.createElement('div');
          contentcontainer.className = 'content-container';
          var header = document.createElement('div');
          header.className = 'header';
          var content = document.createElement('div');
          content.className = 'content';
          var text = document.createElement('div');
          text.className = 'text';
          var header2 = document.createElement('div');
          header2.className = 'header-2';
          header2.innerHTML = project.title;
          var subhead = document.createElement('div');
          subhead.className = 'subhead';
          subhead.innerHTML = project.abstract.slice(0,70) + '...';
          text.appendChild(header2);
          text.appendChild(subhead);
          content.appendChild(text);
          header.appendChild(content);
          contentcontainer.appendChild(header);
          projectcard.appendChild(cardstate);
          projectcard.appendChild(contentcontainer);
          document.getElementsByClassName('frame')[0].appendChild(projectcard);
        });
      }
    }

    $(document).ready(function() {
      fetchCurrentProjects();
    document.getElementById('createproject').addEventListener('click', function() {
      window.location.href = '/createproject';
    });
    const menu = document.getElementById('toggleNav');
    const drawer = document.querySelector('.navigation-drawer');
    const main = document.querySelector('.user-dashboard');
    menu.addEventListener('click', function(e) {
      drawer.classList.toggle('open');
      e.stopPropagation();
    });
    main.addEventListener('click', function() {
      drawer.classList.remove('open');
    });
  });
  </script>
</html>